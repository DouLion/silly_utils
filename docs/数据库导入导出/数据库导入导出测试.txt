
m_conn = "Driver={DM8 ODBC DRIVER};Server=192.168.0.237;TCP_PORT=13308;UID=SYSDBA;PWD=SYSDBA001;"


mysql
CREATE TABLE IF NOT EXISTS ST_PPTN_R (
    STCD VARCHAR(8) NOT NULL,
    TM DATETIME NOT NULL,
    DRP DECIMAL(5, 1) DEFAULT 0,
    INTV DECIMAL(5, 2) DEFAULT 0,
    PDR DECIMAL(5, 2) DEFAULT 0,
    DYP DECIMAL(5, 1) DEFAULT 0,
    WTH VARCHAR(1) DEFAULT NULL,
    PRIMARY KEY (STCD, TM) 
);

mysql
CREATE TABLE IF NOT EXISTS ST_STBPRP_B (
    STCD VARCHAR(8) NOT NULL,
    STNM VARCHAR(30) DEFAULT NULL,
    RVNM VARCHAR(50) DEFAULT NULL,
    HNNM VARCHAR(30) DEFAULT NULL,
    BSNM VARCHAR(30) DEFAULT NULL,
    LGTD DECIMAL(10, 6) DEFAULT NULL,
    LTTD DECIMAL(10, 6) DEFAULT NULL,
    STLC VARCHAR(80) DEFAULT NULL,
    ADDVCD VARCHAR(6) DEFAULT NULL,
    DTMNM VARCHAR(30) DEFAULT NULL,
    DTMEL DECIMAL(8, 3) DEFAULT NULL,
    DTPR DECIMAL(8, 3) DEFAULT NULL,
    STTP VARCHAR(2) DEFAULT NULL,
    FRGRD VARCHAR(1) DEFAULT NULL,
    ESSTYM VARCHAR(6) DEFAULT NULL,
    BGFRYM VARCHAR(6) DEFAULT NULL,
    ATCUNIT VARCHAR(40) DEFAULT NULL,
    ADMAUTH VARCHAR(40) DEFAULT NULL,
    LOCALITY VARCHAR(20) DEFAULT NULL,
    STBK VARCHAR(1) DEFAULT NULL,
    STAZT DECIMAL(3, 0) DEFAULT NULL,
    DSTRVM DECIMAL(6, 1) DEFAULT NULL,
    DRNA DECIMAL(7, 0) DEFAULT NULL,
    PHCD VARCHAR(10) DEFAULT NULL,
    USFL VARCHAR(1) DEFAULT NULL,
    COMMENTS VARCHAR(200) DEFAULT NULL,
    MODITIME DATETIME DEFAULT NULL,
    HNNM0 VARCHAR(30) DEFAULT NULL,
    ADCD VARCHAR(30) DEFAULT NULL,
    ADDVCD1 VARCHAR(6) DEFAULT NULL,
    PRIMARY KEY (STCD) 
);


上面是在mysql 数据库中创建表的两个表 现在修改成sqlserver数据库的表


Driver={SQL Server};Server=192.168.0.237;Port:11433;Database=TEST;UID=sa;PWD=test123456!;


sql server

CREATE TABLE ST_PPTN_R (
    STCD VARCHAR(8) NOT NULL,
    TM DATETIME NOT NULL,
    DRP DECIMAL(5, 1) DEFAULT 0,
    INTV DECIMAL(5, 2) DEFAULT 0,
    PDR DECIMAL(5, 2) DEFAULT 0,
    DYP DECIMAL(5, 1) DEFAULT 0,
    WTH CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    PRIMARY KEY (STCD, TM)
);



CREATE TABLE ST_STBPRP_B (
    STCD VARCHAR(8) NOT NULL,
    STNM VARCHAR(30) NULL,
    RVNM VARCHAR(50) NULL,
    HNNM VARCHAR(30) NULL,
    BSNM VARCHAR(30) NULL,
    LGTD DECIMAL(10, 6) NULL,
    LTTD DECIMAL(10, 6) NULL,
    STLC VARCHAR(80) NULL,
    ADDVCD VARCHAR(6) NULL,
    DTMNM VARCHAR(30) NULL,
    DTMEL DECIMAL(8, 3) NULL,
    DTPR DECIMAL(8, 3) NULL,
    STTP VARCHAR(2) NULL,
    FRGRD CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    ESSTYM VARCHAR(6) NULL,
    BGFRYM VARCHAR(6) NULL,
    ATCUNIT VARCHAR(40) NULL,
    ADMAUTH VARCHAR(40) NULL,
    LOCALITY VARCHAR(20) NULL,
    STBK CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    STAZT DECIMAL(3, 0) NULL,
    DSTRVM DECIMAL(6, 1) NULL,
    DRNA DECIMAL(7, 0) NULL,
    PHCD VARCHAR(10) NULL,
    USFL CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    COMMENTS VARCHAR(200) NULL,
    MODITIME DATETIME NULL,
    HNNM0 VARCHAR(30) NULL,
    ADCD VARCHAR(30) NULL,
    ADDVCD1 VARCHAR(6) NULL,
    PRIMARY KEY (STCD)
);



dm8

```sql

CREATE TABLE "TEST"."ST_PPTN_R" (
    STCD VARCHAR(8) NOT NULL,
    TM DATETIME NOT NULL,
    DRP DECIMAL(5, 1) DEFAULT 0,
    INTV DECIMAL(5, 2) DEFAULT 0,
    PDR DECIMAL(5, 2) DEFAULT 0,
    DYP DECIMAL(5, 1) DEFAULT 0,
    WTH CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    PRIMARY KEY (STCD, TM)
);

```

### 2. 表 ST_STBPRP_B

```sql
CREATE TABLE "TEST"."ST_STBPRP_B" (
    STCD VARCHAR(8) NOT NULL,
    STNM VARCHAR(30) NULL,
    RVNM VARCHAR(50) NULL,
    HNNM VARCHAR(30) NULL,
    BSNM VARCHAR(30) NULL,
    LGTD DECIMAL(10, 6) NULL,
    LTTD DECIMAL(10, 6) NULL,
    STLC VARCHAR(80) NULL,
    ADDVCD VARCHAR(6) NULL,
    DTMNM VARCHAR(30) NULL,
    DTMEL DECIMAL(8, 3) NULL,
    DTPR DECIMAL(8, 3) NULL,
    STTP VARCHAR(2) NULL,
    FRGRD CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    ESSTYM VARCHAR(6) NULL,
    BGFRYM VARCHAR(6) NULL,
    ATCUNIT VARCHAR(40) NULL,
    ADMAUTH VARCHAR(40) NULL,
    LOCALITY VARCHAR(20) NULL,
    STBK CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    STAZT DECIMAL(3, 0) NULL,
    DSTRVM DECIMAL(6, 1) NULL,
    DRNA DECIMAL(7, 0) NULL,
    PHCD VARCHAR(10) NULL,
    USFL CHAR(1) NULL,  -- CHAR 类型用于替代 VARCHAR(1)
    COMMENTS VARCHAR(200) NULL,
    MODITIME DATETIME NULL,
    HNNM0 VARCHAR(30) NULL,
    ADCD VARCHAR(30) NULL,
    ADDVCD1 VARCHAR(6) NULL,
    PRIMARY KEY (STCD)
);
```




SELECT STCD, TM, DRP, INTV FROM ST_PPTN_R WHERE TM >:f1<char[32]> AND TM <= :f2<char[32]>) ;

[2024-10-12 16:05:52.101]: <silly_otl.cpp:211>
OTL 连接串帮助信息:
 >>> 账号和密码中不要出现 [ ] { } ( ) , ; ? * = ! @ | 这些特殊字符 <<<
SQL Server:
        DRIVER={驱动名称};SERVER=IP;PORT=端口;UID=账号;PWD=密码;DATABASE=数据库;
MySQL:
        Driver={MySQL ODBC 8.0 ANSI Driver};Server=IP;Port=端口;Database=数据库;User=账号;Password=密码;Option=3;charset=UTF8;
Oracle:
        Driver={ODBC驱动名称};DBQ=IP:端口/表空间名称;UID=用户;PWD=密码;Oracle需要另外设置环境变量NLS_LANG=SIMPLIFIED CHINESE_CHINA.UTF8,以支持中文编码utf8传递;
达梦(DM8):
        Driver={驱动名称};Server=IP;TCP_PORT:端口;UID=账号;PWD=密码;
        即使数据库编码为UTF8, 数据在插入时也需要时GBK编码, 否则会乱码;
不能正常使用ODBC时,考虑使用DSN方式:
        UID=账号;PWD=密码;DSN=DNS名称;

[2024-10-12 16:05:52.114]: <silly_otl.cpp:218>

当前机器支持的ODBC驱动:
SQL Native Client
SQL Server Native Client 11.0
SQLite3 ODBC Driver
Devart ODBC Driver for SQL Server
Microsoft Access Driver (*.mdb, *.accdb)
Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)
Microsoft Access Text Driver (*.txt, *.csv)
ODBC Driver 13 for SQL Server
Oracle in instantclient_12_2
MySQL ODBC 8.0 ANSI Driver
MySQL ODBC 8.0 Unicode Driver
DM8 ODBC DRIVER


SQL Server Native Client 11.0




ST_RSVR_R 表

CREATE TABLE ST_RSVR_R (
    STCD VARCHAR(8) PRIMARY KEY,   -- 假设 STCD 是主键
    TM DATE,
    RZ DECIMAL(7, 3),
    INQ DECIMAL(9, 3),
    W DECIMAL(9, 3),
    OTQ DECIMAL(9, 3),
    RWCHRCD VARCHAR(1),
    RWPTN VARCHAR(1),
    INQDR DECIMAL(5, 2),
    MSQMT VARCHAR(1),
    BLRZ DECIMAL(7, 3)
);


ST_RIVER_R 表

CREATE TABLE ST_RIVER_R (
    STCD VARCHAR(8),            -- 流域代码，最大长度 8
    TM DATETIME,                -- 时间戳
    Z DECIMAL(7, 3),            -- 数值 Z，最多 7 位数字，其中 3 位小数
    Q DECIMAL(9, 3),            -- 数值 Q，最多 9 位数字，其中 3 位小数
    XSA DECIMAL(9, 3),          -- 数值 XSA，最多 9 位数字，其中 3 位小数
    XSAVV DECIMAL(5, 3),        -- 数值 XSAVV，最多 5 位数字，其中 3 位小数
    XSMXV DECIMAL(5, 3),        -- 数值 XSMXV，最多 5 位数字，其中 3 位小数
    FLWCHRCD CHAR(1),           -- 流量控制字符，1 字符
    WPTN CHAR(1),               -- 水位监测字符，1 字符
    MSQMT CHAR(1),              -- 月度水质字符，1 字符
    MSAMT CHAR(1),              -- 月度水量字符，1 字符
    MSVMT CHAR(1)               -- 月度水位字符，1 字符
);









